{% extends 'base.html.twig' %}

{% block title %}Users List{% endblock %}

{% block body %}

    <!-- MAIN CONTENT-->
    <div class="section__content section__content--p30">
        <div class="container-fluid">
            <div class="row">
                <div class="col-lg-12">
                    <!-- USER DATA-->
                    <div class="user-data m-b-30">
                        <h3 class="title-3 m-b-30">
                            <i class="zmdi zmdi-account-calendar"></i>user data</h3>
                        {#<div class="filters m-b-45">
                            <div class="rs-select2--dark rs-select2--md m-r-10 rs-select2--border">
                                <select class="js-select2" name="property">
                                    <option selected="selected">All Properties</option>
                                    <option value="">Products</option>
                                    <option value="">Services</option>
                                </select>
                                <div class="dropDownSelect2"></div>
                            </div>
                            <div class="rs-select2--dark rs-select2--sm rs-select2--border">
                                <select class="js-select2 au-select-dark" name="time">
                                    <option selected="selected">All Time</option>
                                    <option value="">By Month</option>
                                    <option value="">By Day</option>
                                </select>
                                <div class="dropDownSelect2"></div>
                            </div>
                        </div>#}
                        <div class="table-responsive table-data">
                            <table id="table-data" class="table">
                                <thead>
                                    <tr>
                                        <td>name</td>
                                        <td>role</td>
                                        <td>type</td>
                                        <td>active</td>
                                        <td></td>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for user in users %}
                                        <tr>
                                            <td>
                                                <div class="table-data__info">
                                                    <h6>{{ user.username }}</h6>
                                                    <span><a href="#">{{ user.email }}</a></span>
                                                </div>
                                            </td>
                                            <td>
                                                {% if user.roles[0] == "ROLE_ADMIN" %}
                                                    <span class="role admin">Admin</span>
                                                {% elseif user.roles[0] == "ROLE_SUPER_ADMIN" %}
                                                    <span class="role member">Super Admin</span>
                                                {% else %}
                                                    <span class="role user">User</span>
                                                {% endif %}
                                            </td>
                                            <td>
                                                <div class="table-data__info">
                                                    <h6>
                                                        {% if user.roles[0] == "ROLE_ADMIN" %}
                                                            administrator
                                                        {% elseif user.roles[0] == "ROLE_SUPER_ADMIN" %}
                                                            Full Control
                                                        {% else  %}
                                                            Editior
                                                        {% endif %}
                                                    </h6>
                                                </div>
                                            </td>
                                            <td>
                                                <label class="switch switch-3d switch-success mr-3">
                                                    <input type="checkbox" value="{{ path('user_active', {'id': user.id}) }}" class="switch-input" {% if user.isValid == true %}checked="true"{% endif %} {% if not (is_granted('ROLE_ADMIN')) or app.user == user %}disabled=""{% endif %}>
                                                    <span class="switch-label"></span>
                                                    <span class="switch-handle"></span>
                                                </label>
                                            </td>
                                            <td>
                                                <div class="table-data-feature">
                                                    {% if not is_granted('ROLE_PREVIOUS_ADMIN') and is_granted('ROLE_SUPER_ADMIN') and user != app.user %}
                                                        <a href="{{ path('index_default', {'_switch_user': user.email}) }}" class="item" data-toggle="tooltip" data-placement="top" title="switch to user">
                                                            <i class="zmdi zmdi-sign-in"></i>
                                                        </a>
                                                    {% endif %}
                                                    {% if is_granted('ROLE_ADMIN') and user != app.user %}
                                                        <div class="roleEdit" data-toggle="tooltip" data-placement="top" title="edit role">
                                                            <button type="button" class="item" data-url="{{ path('user_role') }}" data-id="{{ user.id }}" data-toggle="modal" data-target="#roleModal">
                                                                <i class="zmdi zmdi-edit"></i>
                                                            </button>
                                                        </div>
                                                    {% endif %}
                                                </div>
                                            </td>
                                        </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <!-- END USER DATA-->
                </div>
            </div>
        </div>
    </div>
{% endblock %}

{% block modals %}
    <!-- modal static -->
    <div class="modal fade" id="roleModal" tabindex="-1" role="dialog" aria-labelledby="staticModalLabel" aria-hidden="true" data-backdrop="static">
        <div class="modal-dialog modal-sm" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="staticModalLabel">Edit user</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="row form-group">
                        <div class="col col-md-3">
                            <label for="selectSm" class=" form-control-label">Role</label>
                        </div>
                        <div class="col-12 col-md-9">
                            <select name="selectSm" id="SelectLm" class="form-control-sm form-control">
                                <option value="" disabled selected>Please select</option>
                                <option value="1">Full Control</option>
                                <option value="2">Administrator</option>
                                <option value="3">Editor</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary btn-sm" data-dismiss="modal">Cancel</button>
                    <button type="button" class="roleSubmit btn btn-primary btn-sm">Confirm</button>
                </div>
            </div>
        </div>
    </div>
    <!-- end modal static -->
{% endblock %}